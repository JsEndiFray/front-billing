<div class="container">
  <!-- T√≠tulo y descripci√≥n -->
  <div class="header">
    <h1 class="title">Editar Cliente</h1>
    <p class="subtitle">Modificar informaci√≥n del cliente existente</p>
  </div>

  <!-- Formulario principal -->
  <form (ngSubmit)="updateClient()">

    <!-- Secci√≥n: Informaci√≥n b√°sica -->
    <div class="section">
      <h2 class="section-title">üìã Informaci√≥n B√°sica</h2>
      <div class="form-grid">

        <div class="form-field">
          <label for="type_client" class="form-label">Tipo de Cliente *</label>
          <select
            [(ngModel)]="client.type_client"
            name="type_client"
            id="type_client"
            class="form-select"
            required>
            <option value="">Seleccionar tipo</option>
            <option value="particular">Particular</option>
            <option value="autonomo">Aut√≥nomo</option>
            <option value="empresa">Empresa</option>
          </select>
        </div>

        <div class="form-field">
          <label for="name" class="form-label">Nombre *</label>
          <input
            type="text"
            [(ngModel)]="client.name"
            name="name"
            id="name"
            placeholder="Nombre del cliente"
            class="form-input"
            required>
        </div>

        <div class="form-field">
          <label for="lastname" class="form-label">Apellidos *</label>
          <input
            type="text"
            [(ngModel)]="client.lastname"
            name="lastname"
            id="lastname"
            placeholder="Apellidos del cliente"
            class="form-input"
            required>
        </div>

        <div class="form-field">
          <label for="identification" class="form-label">Identificaci√≥n *</label>
          <input
            type="text"
            [(ngModel)]="client.identification"
            name="identification"
            id="identification"
            placeholder="DNI/NIE/CIF"
            class="form-input identification-input"
            required>
        </div>

      </div>
    </div>

    <!-- Secci√≥n: Informaci√≥n de contacto -->
    <div class="section">
      <h2 class="section-title">üìû Informaci√≥n de Contacto</h2>
      <div class="form-grid">

        <div class="form-field">
          <label for="email" class="form-label">Email *</label>
          <input
            type="email"
            [(ngModel)]="client.email"
            name="email"
            id="email"
            placeholder="cliente@email.com"
            class="form-input"
            required>
        </div>

        <div class="form-field">
          <label for="phone" class="form-label">Tel√©fono *</label>
          <input
            type="tel"
            [(ngModel)]="client.phone"
            name="phone"
            id="phone"
            placeholder="123 456 789"
            class="form-input"
            required>
        </div>

      </div>
    </div>

    <!-- Secci√≥n: Direcci√≥n -->
    <div class="section">
      <h2 class="section-title">üè† Direcci√≥n</h2>
      <div class="form-grid">

        <div class="form-field form-field-full">
          <label for="address" class="form-label">Direcci√≥n</label>
          <input
            type="text"
            [(ngModel)]="client.address"
            name="address"
            id="address"
            placeholder="Calle Principal 123"
            class="form-input">
        </div>

        <div class="form-field">
          <label for="postal_code" class="form-label">C√≥digo Postal</label>
          <input
            type="text"
            [(ngModel)]="client.postal_code"
            name="postal_code"
            id="postal_code"
            placeholder="28001"
            class="form-input postal-input"
            pattern="[0-9]{5}"
            maxlength="5">
        </div>

        <div class="form-field">
          <label for="location" class="form-label">Localidad</label>
          <input
            type="text"
            [(ngModel)]="client.location"
            name="location"
            id="location"
            placeholder="Madrid"
            class="form-input">
        </div>

        <div class="form-field">
          <label for="province" class="form-label">Provincia</label>
          <input
            type="text"
            [(ngModel)]="client.province"
            name="province"
            id="province"
            placeholder="Madrid"
            class="form-input">
        </div>

        <div class="form-field">
          <label for="country" class="form-label">Pa√≠s</label>
          <input
            type="text"
            [(ngModel)]="client.country"
            name="country"
            id="country"
            placeholder="Espa√±a"
            class="form-input"
            value="Espa√±a">
        </div>

      </div>
    </div>

    <!-- Secci√≥n: Informaci√≥n empresarial -->
    @if (client.type_client === 'empresa' || client.type_client === 'autonomo') {
      <div class="section">
        <h2 class="section-title">üè¢ Informaci√≥n Empresarial</h2>
        <div class="form-grid">

          <div class="form-field">
            <label for="company_name" class="form-label">Nombre de Empresa</label>
            <input
              type="text"
              [(ngModel)]="client.company_name"
              name="company_name"
              id="company_name"
              placeholder="Empresa S.L."
              class="form-input company-input">
          </div>

          @if (client.type_client === 'autonomo') {
            <div class="form-field">
              <label for="parent_company_name" class="form-label">Empresa Relacionada</label>
              <input
                type="text"
                [(ngModel)]="client.parent_company_name"
                name="parent_company_name"
                id="parent_company_name"
                placeholder="Empresa relacionada"
                class="form-input"
                readonly>
            </div>

            <div class="form-field">
              <label for="relationship_type" class="form-label">Tipo de Relaci√≥n</label>
              <select
                [(ngModel)]="client.relationship_type"
                name="relationship_type"
                id="relationship_type"
                class="form-select">
                <option value="">Sin relaci√≥n</option>
                <option value="administrator">Administrador</option>
              </select>
            </div>
          }

        </div>
      </div>
    }

    <!-- Secci√≥n: Administrador para empresas -->
    @if (client.type_client === 'empresa') {
      <div class="section">
        <h2 class="section-title">üë®‚Äçüíº Administrador de la Empresa</h2>

        <!-- Tipo de administrador -->
        <div class="admin-type-selection">
          <label class="form-label">¬øC√≥mo quieres asignar el administrador?</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" [(ngModel)]="adminType" name="adminType" value="existing">
              <span>Seleccionar administrador existente</span>
            </label>
            <label class="radio-option">
              <input type="radio" [(ngModel)]="adminType" name="adminType" value="new">
              <span>Crear nuevo administrador</span>
            </label>
          </div>
        </div>

        <div class="form-grid">

          <!-- Selector de administrador existente -->
          @if (adminType === 'existing') {
            <div class="form-field form-field-full">
              <label for="existing_admin" class="form-label">Administrador</label>
              <select
                [(ngModel)]="selectedAdminId"
                name="existing_admin"
                id="existing_admin"
                class="form-select">
                <option value="">Seleccionar administrador</option>
                @for (admin of availableAdmins; track admin.id) {
                  <option [value]="admin.id">{{admin.name}} {{admin.lastname}} - {{admin.identification}}</option>
                }
              </select>
            </div>
          }

          <!-- Formulario para nuevo administrador -->
          @if (adminType === 'new') {
            <div class="form-field">
              <label for="admin_name" class="form-label">Nombre del Administrador *</label>
              <input
                type="text"
                [(ngModel)]="newAdmin.name"
                name="admin_name"
                id="admin_name"
                placeholder="Nombre"
                class="form-input"
                required>
            </div>

            <div class="form-field">
              <label for="admin_lastname" class="form-label">Apellidos *</label>
              <input
                type="text"
                [(ngModel)]="newAdmin.lastname"
                name="admin_lastname"
                id="admin_lastname"
                placeholder="Apellidos"
                class="form-input"
                required>
            </div>

            <div class="form-field">
              <label for="admin_identification" class="form-label">Identificaci√≥n *</label>
              <input
                type="text"
                [(ngModel)]="newAdmin.identification"
                name="admin_identification"
                id="admin_identification"
                placeholder="DNI/NIE"
                class="form-input identification-input"
                required>
            </div>

            <div class="form-field">
              <label for="admin_email" class="form-label">Email *</label>
              <input
                type="email"
                [(ngModel)]="newAdmin.email"
                name="admin_email"
                id="admin_email"
                placeholder="admin@email.com"
                class="form-input"
                required>
            </div>

            <div class="form-field">
              <label for="admin_phone" class="form-label">Tel√©fono *</label>
              <input
                type="tel"
                [(ngModel)]="newAdmin.phone"
                name="admin_phone"
                id="admin_phone"
                placeholder="123 456 789"
                class="form-input"
                required>
            </div>

            <div class="form-field form-field-full">
              <label for="admin_address" class="form-label">Direcci√≥n *</label>
              <input
                type="text"
                [(ngModel)]="newAdmin.address"
                name="admin_address"
                id="admin_address"
                placeholder="Calle Principal 123"
                class="form-input"
                required>
            </div>

            <div class="form-field">
              <label for="admin_postal_code" class="form-label">C√≥digo Postal *</label>
              <input
                type="text"
                [(ngModel)]="newAdmin.postal_code"
                name="admin_postal_code"
                id="admin_postal_code"
                placeholder="28001"
                class="form-input postal-input"
                pattern="[0-9]{5}"
                maxlength="5"
                required>
            </div>

            <div class="form-field">
              <label for="admin_location" class="form-label">Localidad *</label>
              <input
                type="text"
                [(ngModel)]="newAdmin.location"
                name="admin_location"
                id="admin_location"
                placeholder="Madrid"
                class="form-input"
                required>
            </div>

            <div class="form-field">
              <label for="admin_province" class="form-label">Provincia *</label>
              <input
                type="text"
                [(ngModel)]="newAdmin.province"
                name="admin_province"
                id="admin_province"
                placeholder="Madrid"
                class="form-input"
                required>
            </div>

            <div class="form-field">
              <label for="admin_country" class="form-label">Pa√≠s</label>
              <input
                type="text"
                [(ngModel)]="newAdmin.country"
                name="admin_country"
                id="admin_country"
                placeholder="Espa√±a"
                class="form-input"
                value="Espa√±a">
            </div>
          }

        </div>
      </div>
    }

    <!-- Botones de acci√≥n -->
    <div class="actions-section">
      <button type="submit" class="primary-btn">
        ‚úì Actualizar Cliente
      </button>
      <button type="button" class="secondary-btn" (click)="goBack()">
        ‚Üê Cancelar
      </button>
    </div>

  </form>
</div>
