<div class="container">
  <!-- Título y descripción -->
  <div class="header">
    <h1 class="title">Registro de Cliente</h1>
    <p class="subtitle">Crear nuevo cliente con información completa</p>
  </div>

  <!-- Formulario principal -->
  <form #clientForm="ngForm" (ngSubmit)="createClient()">

    <!-- Sección: Selección de tipo -->
    <div class="section">
      <h2 class="section-title">Tipo de Cliente</h2>
      <div class="type-selection">
        <div class="type-card"
             [class.selected]="client.type_client === 'empresa'"
             (click)="selectClientType('empresa')">
          <div class="type-icon">🏢</div>
          <h3>Empresa</h3>
          <p>Sociedades, SL, SA</p>
        </div>

        <div class="type-card"
             [class.selected]="client.type_client === 'particular'"
             (click)="selectClientType('particular')">
          <div class="type-icon">👤</div>
          <h3>Particular</h3>
          <p>Personas físicas</p>
        </div>

        <div class="type-card"
             [class.selected]="client.type_client === 'autonomo'"
             (click)="selectClientType('autonomo')">
          <div class="type-icon">💼</div>
          <h3>Autónomo</h3>
          <p>Trabajadores independientes</p>
        </div>
      </div>

      @if (client.type_client === 'empresa') {
        <div class="info-message">
          💡 Los datos de nombre y apellidos se utilizarán como razón social
        </div>
      }
    </div>

    <!-- Sección: Datos del cliente -->
    <div class="section">
      <h2 class="section-title">Datos del Cliente</h2>
      <div class="form-grid">

        <div class="form-field">
          <label for="name" class="form-label">Nombre *</label>
          <input
            type="text"
            id="name"
            name="name"
            [(ngModel)]="client.name"
            (ngModelChange)="updateCompanyName()"
            placeholder="Introduce el nombre"
            class="form-input"
            required>
        </div>

        <div class="form-field">
          <label for="lastname" class="form-label">Apellidos *</label>
          <input
            type="text"
            id="lastname"
            name="lastname"
            [(ngModel)]="client.lastname"
            (ngModelChange)="updateCompanyName()"
            placeholder="Introduce los apellidos"
            class="form-input"
            required>
        </div>

        @if (client.type_client === 'empresa') {
          <div class="form-field form-field-full">
            <label for="company_name" class="form-label">Razón Social *</label>
            <input
              type="text"
              id="company_name"
              name="company_name"
              [(ngModel)]="client.company_name"
              placeholder="Se completa automáticamente"
              class="form-input company-input"
              required>
          </div>
        }

        <div class="form-field">
          <label for="identification" class="form-label">
            @if (client.type_client === 'empresa') {
              CIF *
            } @else {
              Identificación *
            }
          </label>
          <input
            type="text"
            id="identification"
            name="identification"
            [(ngModel)]="client.identification"
            [placeholder]="getIdentificationPlaceholder()"
            class="form-input identification-input"
            required>
        </div>

        <div class="form-field">
          <label for="phone" class="form-label">Teléfono *</label>
          <input
            type="tel"
            id="phone"
            name="phone"
            [(ngModel)]="client.phone"
            placeholder="+34 123 456 789"
            class="form-input"
            required>
        </div>

        <div class="form-field">
          <label for="email" class="form-label">Email *</label>
          <input
            type="email"
            id="email"
            name="email"
            [(ngModel)]="client.email"
            placeholder="ejemplo@correo.com"
            class="form-input"
            required>
        </div>

        <div class="form-field form-field-full">
          <label for="address" class="form-label">Dirección *</label>
          <input
            type="text"
            id="address"
            name="address"
            [(ngModel)]="client.address"
            placeholder="Calle, número, piso..."
            class="form-input"
            required>
        </div>

        <div class="form-field">
          <label for="postal_code" class="form-label">Código Postal *</label>
          <input
            type="text"
            id="postal_code"
            name="postal_code"
            [(ngModel)]="client.postal_code"
            placeholder="28001"
            class="form-input postal-input"
            maxlength="5"
            required>
        </div>

        <div class="form-field">
          <label for="location" class="form-label">Localidad *</label>
          <input
            type="text"
            id="location"
            name="location"
            [(ngModel)]="client.location"
            placeholder="Madrid"
            class="form-input"
            required>
        </div>

        <div class="form-field">
          <label for="province" class="form-label">Provincia *</label>
          <input
            type="text"
            id="province"
            name="province"
            [(ngModel)]="client.province"
            placeholder="Madrid"
            class="form-input"
            required>
        </div>

        <div class="form-field">
          <label for="country" class="form-label">País *</label>
          <input
            type="text"
            id="country"
            name="country"
            [(ngModel)]="client.country"
            value="España"
            class="form-input"
            required>
        </div>

      </div>
    </div>

    <!-- Sección: Administradores (solo empresas) -->
    @if (client.type_client === 'empresa') {
      <div class="section">
        <h2 class="section-title">Administradores (Opcional)</h2>

        <div class="info-message">
          📋 Puede añadir administradores autónomos para esta empresa
        </div>

        <div class="admin-actions">
          <button type="button" class="add-admin-btn" (click)="addAdministrator()">
            + Añadir Administrador
          </button>
        </div>

        @for (admin of administrators; track $index) {
          <div class="admin-container">
            <div class="admin-header">
              <h3>👤 Administrador {{$index + 1}}</h3>
              <button type="button" class="remove-admin-btn" (click)="removeAdministrator($index)">
                Eliminar
              </button>
            </div>

            <div class="form-grid">
              <div class="form-field">
                <label [for]="'admin_name_' + $index" class="form-label">Nombre *</label>
                <input
                  type="text"
                  [id]="'admin_name_' + $index"
                  [(ngModel)]="admin.name"
                  [name]="'admin_name_' + $index"
                  placeholder="Nombre del administrador"
                  class="form-input"
                  required>
              </div>

              <div class="form-field">
                <label [for]="'admin_lastname_' + $index" class="form-label">Apellidos *</label>
                <input
                  type="text"
                  [id]="'admin_lastname_' + $index"
                  [(ngModel)]="admin.lastname"
                  [name]="'admin_lastname_' + $index"
                  placeholder="Apellidos del administrador"
                  class="form-input"
                  required>
              </div>

              <div class="form-field">
                <label [for]="'admin_identification_' + $index" class="form-label">Identificación *</label>
                <input
                  type="text"
                  [id]="'admin_identification_' + $index"
                  [(ngModel)]="admin.identification"
                  [name]="'admin_identification_' + $index"
                  placeholder="NIF, NIE o Pasaporte"
                  class="form-input identification-input"
                  required>
              </div>

              <div class="form-field">
                <label [for]="'admin_phone_' + $index" class="form-label">Teléfono *</label>
                <input
                  type="tel"
                  [id]="'admin_phone_' + $index"
                  [(ngModel)]="admin.phone"
                  [name]="'admin_phone_' + $index"
                  placeholder="+34 123 456 789"
                  class="form-input"
                  required>
              </div>

              <div class="form-field">
                <label [for]="'admin_email_' + $index" class="form-label">Email *</label>
                <input
                  type="email"
                  [id]="'admin_email_' + $index"
                  [(ngModel)]="admin.email"
                  [name]="'admin_email_' + $index"
                  placeholder="admin@empresa.com"
                  class="form-input"
                  required>
              </div>

              <div class="form-field form-field-full">
                <label [for]="'admin_address_' + $index" class="form-label">Dirección *</label>
                <input
                  type="text"
                  [id]="'admin_address_' + $index"
                  [(ngModel)]="admin.address"
                  [name]="'admin_address_' + $index"
                  placeholder="Dirección completa"
                  class="form-input"
                  required>
              </div>

              <div class="form-field">
                <label [for]="'admin_postal_code_' + $index" class="form-label">C.P. *</label>
                <input
                  type="text"
                  [id]="'admin_postal_code_' + $index"
                  [(ngModel)]="admin.postal_code"
                  [name]="'admin_postal_code_' + $index"
                  placeholder="28001"
                  class="form-input postal-input"
                  maxlength="5"
                  required>
              </div>

              <div class="form-field">
                <label [for]="'admin_location_' + $index" class="form-label">Localidad *</label>
                <input
                  type="text"
                  [id]="'admin_location_' + $index"
                  [(ngModel)]="admin.location"
                  [name]="'admin_location_' + $index"
                  placeholder="Madrid"
                  class="form-input"
                  required>
              </div>

              <div class="form-field">
                <label [for]="'admin_province_' + $index" class="form-label">Provincia *</label>
                <input
                  type="text"
                  [id]="'admin_province_' + $index"
                  [(ngModel)]="admin.province"
                  [name]="'admin_province_' + $index"
                  placeholder="Madrid"
                  class="form-input"
                  required>
              </div>

              <div class="form-field">
                <label [for]="'admin_country_' + $index" class="form-label">País *</label>
                <input
                  type="text"
                  [id]="'admin_country_' + $index"
                  [(ngModel)]="admin.country"
                  [name]="'admin_country_' + $index"
                  value="España"
                  class="form-input"
                  required>
              </div>
            </div>
          </div>
        }
      </div>
    }

    <!-- Botones de acción -->
    <div class="actions-section">
      <button type="submit" class="primary-btn">
        @if (client.type_client === 'empresa') {
          🏢 Crear Empresa
        } @else {
          👤 Crear Cliente
        }
      </button>
      <button type="button" class="secondary-btn" (click)="goBack()">
        ← Volver al Listado
      </button>
    </div>

  </form>
</div>
